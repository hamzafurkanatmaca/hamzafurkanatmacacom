---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';
import { getCollection } from 'astro:content';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={`Blog | ${SITE_TITLE}`} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<section class="blog-header">
				<div class="header-glow"></div>
				<h1>Blog</h1>
				<p>Insights on .NET development, cloud architecture, AI integration, and software engineering best practices.</p>
			</section>
			
			<section class="posts-container">
				{posts.length > 0 && (
					<a href={`/blog/${posts[0].id}/`} class="featured-post">
						<div class="featured-image">
							<img src={posts[0].data.heroImage} alt="" loading="eager" />
							<div class="featured-badge">Featured</div>
						</div>
						<div class="featured-content">
							<span class="post-date">
								<FormattedDate date={posts[0].data.pubDate} />
							</span>
							<h2>{posts[0].data.title}</h2>
							<p>{posts[0].data.description}</p>
							<span class="read-more">
								Read article
								<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<path d="M5 12h14"/>
									<path d="m12 5 7 7-7 7"/>
								</svg>
							</span>
						</div>
					</a>
				)}
				
				<div class="posts-grid">
					{posts.slice(1).map((post) => (
						<a href={`/blog/${post.id}/`} class="post-card">
							<div class="post-image">
								<img src={post.data.heroImage} alt="" loading="lazy" />
							</div>
							<div class="post-content">
								<span class="post-date">
									<FormattedDate date={post.data.pubDate} />
								</span>
								<h3>{post.data.title}</h3>
								<p>{post.data.description}</p>
							</div>
						</a>
					))}
				</div>
			</section>
		</main>
		<Footer />
		
		<style>
			main {
				padding-top: 72px;
				max-width: 1200px;
			}
			
			/* Blog Header */
			.blog-header {
				position: relative;
				text-align: center;
				padding: var(--space-3xl) 0;
				margin-bottom: var(--space-xl);
			}
			
			.header-glow {
				position: absolute;
				top: -100px;
				left: 50%;
				transform: translateX(-50%);
				width: 600px;
				height: 400px;
				background: radial-gradient(ellipse, var(--accent-glow) 0%, transparent 70%);
				pointer-events: none;
				opacity: 0.3;
			}
			
			.blog-header h1 {
				position: relative;
				font-size: clamp(2.5rem, 5vw, 3.5rem);
				margin-bottom: var(--space-md);
			}
			
			.blog-header p {
				position: relative;
				color: var(--text-muted);
				font-size: 1.15rem;
				max-width: 600px;
				margin: 0 auto;
			}
			
			/* Posts Container */
			.posts-container {
				padding-bottom: var(--space-3xl);
			}
			
			/* Featured Post */
			.featured-post {
				display: grid;
				grid-template-columns: 1.2fr 1fr;
				gap: var(--space-2xl);
				background: var(--surface);
				border: 1px solid var(--border);
				border-radius: var(--radius-xl);
				overflow: hidden;
				text-decoration: none;
				transition: all var(--transition-base);
				margin-bottom: var(--space-2xl);
			}
			
			.featured-post:hover {
				border-color: var(--border-light);
				box-shadow: var(--shadow-xl);
				transform: translateY(-4px);
			}
			
			.featured-image {
				position: relative;
				aspect-ratio: 16/10;
				overflow: hidden;
			}
			
			.featured-image img {
				width: 100%;
				height: 100%;
				object-fit: cover;
				border-radius: 0;
				transition: transform var(--transition-slow);
			}
			
			.featured-post:hover .featured-image img {
				transform: scale(1.05);
			}
			
			.featured-badge {
				position: absolute;
				top: var(--space-md);
				left: var(--space-md);
				padding: var(--space-xs) var(--space-md);
				background: var(--gradient-accent);
				border-radius: var(--radius-full);
				font-size: 0.8rem;
				font-weight: 600;
				color: white;
			}
			
			.featured-content {
				padding: var(--space-2xl);
				display: flex;
				flex-direction: column;
				justify-content: center;
			}
			
			.featured-content .post-date {
				color: var(--text-muted);
				font-size: 0.9rem;
				margin-bottom: var(--space-md);
			}
			
			.featured-content h2 {
				font-size: clamp(1.5rem, 3vw, 2rem);
				color: var(--text-primary);
				margin-bottom: var(--space-md);
				line-height: 1.3;
				transition: color var(--transition-fast);
			}
			
			.featured-post:hover .featured-content h2 {
				color: var(--accent-light);
			}
			
			.featured-content p {
				color: var(--text-secondary);
				font-size: 1.05rem;
				line-height: 1.7;
				margin-bottom: var(--space-lg);
			}
			
			.read-more {
				display: inline-flex;
				align-items: center;
				gap: var(--space-xs);
				color: var(--accent-light);
				font-weight: 500;
				transition: gap var(--transition-fast);
			}
			
			.featured-post:hover .read-more {
				gap: var(--space-sm);
			}
			
			/* Posts Grid */
			.posts-grid {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
				gap: var(--space-lg);
			}
			
			.post-card {
				display: flex;
				flex-direction: column;
				background: var(--surface);
				border: 1px solid var(--border);
				border-radius: var(--radius-lg);
				overflow: hidden;
				text-decoration: none;
				transition: all var(--transition-base);
			}
			
			.post-card:hover {
				border-color: var(--border-light);
				transform: translateY(-4px);
				box-shadow: var(--shadow-lg);
			}
			
			.post-image {
				position: relative;
				aspect-ratio: 16/10;
				overflow: hidden;
			}
			
			.post-image img {
				width: 100%;
				height: 100%;
				object-fit: cover;
				border-radius: 0;
				transition: transform var(--transition-slow);
			}
			
			.post-card:hover .post-image img {
				transform: scale(1.05);
			}
			
			.post-content {
				padding: var(--space-lg);
				flex: 1;
				display: flex;
				flex-direction: column;
			}
			
			.post-date {
				color: var(--text-muted);
				font-size: 0.85rem;
				margin-bottom: var(--space-sm);
			}
			
			.post-content h3 {
				font-size: 1.2rem;
				color: var(--text-primary);
				margin-bottom: var(--space-sm);
				line-height: 1.4;
				transition: color var(--transition-fast);
			}
			
			.post-card:hover .post-content h3 {
				color: var(--accent-light);
			}
			
			.post-content p {
				color: var(--text-muted);
				font-size: 0.95rem;
				line-height: 1.6;
				margin: 0;
				display: -webkit-box;
				-webkit-line-clamp: 2;
				-webkit-box-orient: vertical;
				overflow: hidden;
			}
			
			/* Responsive */
			@media (max-width: 900px) {
				.featured-post {
					grid-template-columns: 1fr;
				}
				
				.featured-image {
					aspect-ratio: 16/9;
				}
				
				.featured-content {
					padding: var(--space-lg);
				}
			}
			
			@media (max-width: 768px) {
				.blog-header {
					padding: var(--space-2xl) 0;
				}
				
				.posts-grid {
					grid-template-columns: 1fr;
				}
			}
		</style>
	</body>
</html>
